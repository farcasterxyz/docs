# 架构

Farcaster 采用混合架构，将身份信息存储在链上，数据存储在链下。

![架构示意图](/assets/architecture.png)

## 链上部分

Farcaster 的链上系统以 [OP 主网上的智能合约](./contracts.md) 形式实现。只有当安全性和一致性至关重要时，才会在链上执行操作。链上操作的使用被控制在最低限度，以降低成本并提升性能。

仅在少数情况下会执行链上操作，包括：

- 创建 [账户](../what-is-farcaster/accounts.md)。
- 支付租金以 [存储数据](../what-is-farcaster/messages.md#storage)。
- 为 [已连接应用](../what-is-farcaster/apps.md#connected-apps) 添加账户密钥。

## 链下部分

Farcaster 的链下系统是由称为 [枢纽(Hubs)](./hubs.md) 的服务器组成的点对点网络，用于存储用户数据。大多数用户操作都在链下执行，包括：

- 发布新的公开消息。
- 关注其他用户。
- 对帖子做出反应（点赞等）。
- 更新个人资料图片。

当性能和成本是关键考量因素时，操作会在链下执行。在一致性并非严格要求的情况下，通常优先选择链下操作。链下系统通过依赖链上系统的数字签名来确保安全性。

:::tip
注意：文档中涉及的专有名词（如 Hubs）和技术术语（如 onchain/offchain）已按技术文档惯例处理，保持术语一致性。
:::
