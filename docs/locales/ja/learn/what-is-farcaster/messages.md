# メッセージ

Farcasterアカウントは、メッセージに署名して公開することによってやり取りします。アリスは「_Hello @bob_」というメッセージを作成し、自分のキーで署名することができます。

メッセージはノードのピアツーピアネットワークに保存されます。Farcasterネットワークのノードはハブと呼ばれ、各ハブはネットワーク全体のコピーを保存します。アカウントは1つのハブにメッセージを公開すると、数秒でネットワーク全体に伝播します。Farcasterのコンパクトなメッセージ形式と最終的に整合性のあるモデルにより、このアーキテクチャは数百万のユーザーにスケールできます。

アカウントは[キー](./accounts.md#adding-account-keys)を生成し、それをアプリに渡してメッセージに署名することができます。アカウントは同じアカウントで複数のアプリを使用でき、各アプリケーションは独自のキーを持つことができます。署名キーを所有キーから分離することで、アカウントのセキュリティを保つことができます。

## 種類

アカウントはネットワークに5種類のメッセージを公開できます:

| 種類          | 説明                                   | 例                        |
| ------------- | --------------------------------------------- | ------------------------------ |
| キャスト         | 誰でも見られる公開メッセージ。   | "Hello world!"                 |
| リアクション     | アカウントとキャストの関係。 | アリスがボブのキャストを気に入った。        |
| リンク         | 2つのアカウント間の関係。          | アリスがボブをフォローしている。             |
| プロフィールデータ  | アカウントに関するメタデータ。                   | プロフィール画像、表示名。 |
| 検証 | 何かの所有権の証明。            | イーサリアムアドレス。           |

## ストレージ

アカウントはFarcasterネットワークにメッセージを保持するためにレンタル料を支払う必要があります。レンタル料を課すことで、アカウントがネットワークをスパムするのを防ぎます。

アカウントはストレージレジストリにオンチェーントランザクションを行うことでストレージユニットをレンタルできます。ストレージユニットの現在の価格は$7で、1年間有効であり、各アカウントが各種類のメッセージを一定数保存できるようにします。現在の各種類の制限は以下の通りです:

- 5000 キャスト
- 2500 リアクション
- 2500 リンク
- 50 プロフィールデータ
- 50 検証

アカウントがメッセージタイプの制限を超えた場合、最も古いメッセージが削除され、新しいメッセージのためのスペースが作られます。アカウントは追加のストレージを支払わずにネットワークを使用し続けることができ、ハブはストレージの負荷を管理できます。アカウントは常に追加のストレージを購入して制限を増やすことができます。

ストレージが期限切れになったアカウントはすべてのメッセージを失う可能性があります。ストレージユニットの期限が切れた後、アカウントは30日間の猶予期間があり、その間に更新しないとメッセージを失います。

各ストレージユニットの価格とサイズは、ネットワークの成長と品質のバランスを取るために定期的に再計算されます。詳細については[FIP-6](https://github.com/farcasterxyz/protocol/discussions/98)を参照してください。

## 削除

アカウントは対応する削除メッセージを公開することで、いつでもメッセージを削除できます。削除メッセージは元のメッセージの内容を削除し、その場所に墓石を残します。削除されたメッセージは、新しいメッセージによって押し出されるまで、アカウントのストレージ制限にカウントされ続けます。

## タイムスタンプ

メッセージにはFarcasterエポックからの秒数をカウントするタイムスタンプがあります。Farcasterエポックは`2021年1月1日 00:00:00 UTC`に始まりました。最近のエポックを使用することで、タイムスタンプとメッセージが非常に小さくなり、ネットワークにとって重要です。

タイムスタンプは未検証であり、ブログ投稿のようにアカウントによってバックデートすることができます。未来の15分以上先には設定できません。ネットワークはそのようなメッセージを拒否します。

## リソース

### 仕様

- [メッセージ](https://github.com/farcasterxyz/protocol/blob/main/docs/SPECIFICATION.md#2-message-specifications) - Farcasterの変更の原子単位
- [CRDTs](https://github.com/farcasterxyz/protocol/blob/main/docs/SPECIFICATION.md#31-crdts) - ネットワーク上でメッセージを同期させるためのルール
- [ストレージレジストリ](https://github.com/farcasterxyz/protocol/blob/main/docs/SPECIFICATION.md#13-storage-registry) - ストレージユニットを取得するための契約
